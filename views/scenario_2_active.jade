extends layout

block content
  // /.container-fluid
  .container.text-center
    // HEADER
    .page-header
      h1 Pull That Face!
      p
        | In this test we will be looking at how facial analysis could be used in an interactive game.
    // CONTENT
    .row
      h3
        | Scenario ends in 
        span#countdowntimer 20 
        |  Seconds
    .row.greybackground
      .col-sm-6
        h4 Live Video
        video#video(autoplay='true', onplay='snap();setInterval(snap, 1500);begincount()')
          | Video stream not available.
      .col-sm-6
        h4 Tested Frames
        .canvas_container
          canvas#canvas
    .row.greybackground
      .col-sm-12.distress_ok User appears to be OK.
      .col-sm-12.distress_help Hey, is everything ok? You're looking a little upset.
    .row
      a.btn.btn-default.btn-lg(href='/', role='button') Back
      a.btn.btn-primary.btn-lg(href='/scenario_1_active', role='button') Begin Scenario
  script(src='js/show_camera.js')
  script.
    //DISPLAYS IMAGE ON CANVAS
    //start the script   ... within that declare variables as follows...
    var video=document.querySelector('video');
    var canvas=document.querySelector('canvas');
    var context=canvas.getContext('2d');
    var w,h,ratio;
    //add loadedmetadata which will helps to identify video attributes......
    video.addEventListener('loadedmetadata',function()
    {
    ratio=video.videoWidth/video.videoHeight;
    w=video.videoWidth-100;
    h=parseInt(w/ratio,10);
    canvas.width=w;
    canvas.height=h;
    },false);
    ///define a function
    function snap()  {
    context.fillRect(0,0,w,h);
    context.drawImage(video,0,0,w,h);
    }
    //TIMER COUNT
    function begincount()  {
    var timeleft = 20;
    var downloadTimer = setInterval(function(){
    timeleft--;
    document.getElementById("countdowntimer").textContent = timeleft;
    if(timeleft <= 0) {
    clearInterval(downloadTimer);
    }
    },1000);
    }